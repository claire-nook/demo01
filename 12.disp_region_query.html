<!DOCTYPE html>
<html lang="zh-Hant">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>基本資料管理 - 派遣區域維護 - 查詢</title>
        <style>
            body {
                font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans TC", sans-serif;
                margin: 0;
                padding: 1rem;
                background: #fff;
            }
            h2 {
                margin: 0 0 1rem;
            }

            .pc-wrapper {
                max-width: 1000px;
                margin: 0 auto;
            }

            /* 查詢區塊 */
            .query-form {
                background: #fff;
                padding: 1rem;
                margin-bottom: 1rem;
                border-radius: 12px;
                box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
            }
            .query-form label {
                display: block;
                margin: 0.5rem 0 0.25rem;
                font-weight: 600;
            }
            .query-form input,
            .query-form select {
                width: 100%;
                padding: 0.5rem;
                border-radius: 6px;
                border: 1px solid #ccc;
                box-sizing: border-box;
                background: #fff;
            }

            /* 為了避免欄位互擠與超出容器，採用 minmax 與 min-width:0 */
            .inline-row {
                display: grid;
                grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);
                gap: 1rem;
            }
            .inline-row > div {
                min-width: 0;
            }

            .btn-area {
                margin-top: 1rem;
                display: flex;
                gap: 1rem;
                justify-content: center;
            }
            .btn {
                padding: 0.6rem 1.2rem;
                border: none;
                border-radius: 6px;
                cursor: pointer;
                font-weight: 700;
            }
            .btn-clear {
                background: #ccc;
                color: #000;
            }
            .btn-search {
                background: #2f855a;
                color: #fff;
            }
            .btn-add {
                background: #007bff;
                color: #fff;
            }

            /* PC / Mobile 切換 */
            .pc {
                display: block;
            }
            .mobile {
                display: none;
            }

            /* 表格 */
            table {
                width: 100%;
                border-collapse: collapse;
                background: #fff;
                box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
                border-radius: 8px;
                overflow: hidden;
            }
            th,
            td {
                padding: 0.75rem;
                border-bottom: 1px solid #ddd;
                text-align: left;
            }
            th {
                background: #f5f5f5;
            }
            a {
                color: #007bff;
                text-decoration: underline;
                font-size: 0.95rem;
            }

            /* Card (Mobile) */
            .card {
                background: #fff;
                border-radius: 12px;
                padding: 1rem;
                margin-bottom: 1rem;
                box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
            }
            .card div {
                margin-bottom: 0.35rem;
            }
            .badge {
                display: inline-block;
                padding: 0.1rem 0.5rem;
                border: 1px solid #bbb;
                border-radius: 999px;
                font-size: 0.8rem;
            }
            .btn-view {
                background: transparent;
                color: #3182ce;
                border: 1px solid #3182ce;
                border-radius: 4px;
                padding: 4px 8px;
                font-size: 0.9rem;
                margin-top: 0.5rem;
                cursor: pointer;
                transition: all 0.2s ease;
                display: inline-block;
            }
            .btn-view:hover {
                background: #3182ce;
                color: #fff;
            }

            /* Mobile 響應式 */
            @media (max-width: 767px) {
                .pc {
                    display: none;
                }
                .mobile {
                    display: block;
                }
                input,
                select,
                textarea,
                button {
                    font-size: 16px !important;
                    height: 40px !important;
                    padding: 8px 10px !important;
                    box-sizing: border-box;
                }
                label {
                    font-size: 1rem;
                }
                .btn {
                    font-size: 1rem;
                    padding: 0.6rem 1.2rem;
                }
                .card div {
                    font-size: 1rem;
                }
                /* iOS 下下拉與日期欄位的可讀樣式 */
                input[type="date"],
                input[type="time"],
                input[type="datetime-local"] {
                    background: #fff !important;
                    color: #222;
                    -webkit-text-fill-color: #222;
                    border: 1px solid #ccc;
                }
                select {
                    -webkit-appearance: none;
                    appearance: none;
                    background: #fff !important;
                    color: #222;
                    border: 1px solid #ccc;
                    padding-right: 2rem;
                    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="%23666" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>');
                    background-repeat: no-repeat;
                    background-position: right 0.6rem center;
                    background-size: 1rem;
                }
                input[readonly],
                textarea[readonly],
                select[disabled],
                input[disabled] {
                    background: #f2f2f2 !important;
                    color: #888 !important;
                    border-color: #ddd !important;
                }
            }
        </style>
    </head>
    <body>
        <h2>派遣區域維護</h2>

        <div class="pc-wrapper">
            <!-- PC：主管雛型 -->
            <div class="query-form pc">
                <div class="inline-row">
                    <div>
                        <label for="rCodePc">派遣區域代碼</label>
                        <input id="rCodePc" type="text" placeholder="例如 R001" />
                    </div>
                    <div>
                        <label for="rNamePc">派遣區域名稱</label>
                        <input id="rNamePc" type="text" placeholder="例如 雙北區" />
                    </div>
                </div>
                <div class="inline-row">
                    <div>
                        <label for="isActivePc">狀態</label>
                        <select id="isActivePc">
                            <option value="">全部</option>
                            <option value="1">啟用</option>
                            <option value="0">停用</option>
                        </select>
                    </div>
                    <div></div>
                </div>
                <div class="btn-area">
                    <button class="btn btn-add" onclick="goNew()">新增</button>
                    <button class="btn btn-search" onclick="query('pc')">查詢</button>
                    <button class="btn btn-clear" onclick="clearForm('pc')">清除</button>
                </div>
            </div>

            <!-- PC 結果 Table -->
            <div class="pc">
                <table id="pcTable">
                    <thead>
                        <tr>
                            <th>派遣區域代碼</th>
                            <th>派遣區域名稱</th>
                            <th>狀態</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Mobile：外勤雛型 -->
        <div class="mobile">
            <div class="query-form">
                <label for="rNameMb">派遣區域名稱</label>
                <input id="rNameMb" type="text" placeholder="輸入關鍵字" />

                <label for="isActiveMb">狀態</label>
                <select id="isActiveMb">
                    <option value="">全部</option>
                    <option value="1">啟用</option>
                    <option value="0">停用</option>
                </select>

                <div class="btn-area">
                    <button class="btn btn-add" onclick="goNew()">新增</button>
                    <button class="btn btn-search" onclick="query('mb')">查詢</button>
                    <button class="btn btn-clear" onclick="clearForm('mb')">清除</button>
                </div>
            </div>

            <div id="mbCards"></div>
        </div>

        <script>
            function goNew() {
                location.href = "12.disp_region_new.html";
            }

            // 假資料：派遣區域清單
            const SAMPLE = [
                { REGION_CODE: "R001", REGION_NAME: "台北市區", IS_ACTIVE: 1 },
                { REGION_CODE: "R002", REGION_NAME: "新北東區", IS_ACTIVE: 1 },
                { REGION_CODE: "R003", REGION_NAME: "桃園沿海", IS_ACTIVE: 0 },
                { REGION_CODE: "R010", REGION_NAME: "高雄市區", IS_ACTIVE: 1 },
            ];

            function ready() {
                renderPc(SAMPLE);
                renderMb(SAMPLE);
            }

            function clearForm(mode) {
                if (mode === "pc") {
                    ["rCodePc", "rNamePc"].forEach((id) => {
                        const el = document.getElementById(id);
                        if (el) el.value = "";
                    });
                    ["isActivePc"].forEach((id) => {
                        const el = document.getElementById(id);
                        if (el) el.selectedIndex = 0;
                    });
                } else {
                    ["rNameMb"].forEach((id) => {
                        const el = document.getElementById(id);
                        if (el) el.value = "";
                    });
                    ["isActiveMb"].forEach((id) => {
                        const el = document.getElementById(id);
                        if (el) el.selectedIndex = 0;
                    });
                }
            }

            function query(mode) {
                const cond = {};
                if (mode === "pc") {
                    cond.code = document.getElementById("rCodePc").value.trim();
                    cond.name = document.getElementById("rNamePc").value.trim();
                    cond.isAct = document.getElementById("isActivePc").value;
                } else {
                    cond.name = document.getElementById("rNameMb").value.trim();
                    cond.isAct = document.getElementById("isActiveMb").value;
                }
                const rows = SAMPLE.filter(
                    (r) => (!cond.code || r.REGION_CODE.toUpperCase().includes(cond.code.toUpperCase())) && (!cond.name || r.REGION_NAME.includes(cond.name)) && (!cond.isAct || String(r.IS_ACTIVE) === String(cond.isAct))
                );
                if (mode === "pc") renderPc(rows);
                else renderMb(rows);
            }

            function renderPc(rows) {
                const tb = document.querySelector("#pcTable tbody");
                if (!tb) return;
                if (!rows.length) {
                    tb.innerHTML = '<tr><td colspan="3">無資料</td></tr>';
                    return;
                }
                tb.innerHTML = rows
                    .map((r) => {
                        const status = r.IS_ACTIVE ? "啟用" : "停用";
                        return `<tr>
            <td><a href="12.disp_region_new.html?code=${encodeURIComponent(r.REGION_CODE)}">${r.REGION_CODE}</a></td>
            <td>${r.REGION_NAME}</td>
            <td>${status}</td>
          </tr>`;
                    })
                    .join("");
            }

            function renderMb(rows) {
                const wrap = document.getElementById("mbCards");
                if (!wrap) return;
                if (!rows.length) {
                    wrap.innerHTML = '<div class="card">無資料</div>';
                    return;
                }
                wrap.innerHTML = rows
                    .map((r) => {
                        const status = r.IS_ACTIVE ? "啟用" : "停用";
                        return `<div class="card">
            <div><strong>${r.REGION_NAME}</strong> <span class="badge">${r.REGION_CODE}</span></div>
            <div>狀態：${status}</div>
            <button class="btn-view" onclick="location.href='14.disp_region_detail.html?code=${encodeURIComponent(r.REGION_CODE)}'">查看明細</button>
          </div>`;
                    })
                    .join("");
            }

            document.addEventListener("DOMContentLoaded", ready);
        </script>
    </body>
</html>
